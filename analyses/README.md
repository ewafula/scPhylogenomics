## Analysis Modules

This directory contains analysis modules for the scPhylogenomics workflow, which utilizes phylogenetic approaches to infer clonal tumor evolution from scRNA-Seq SNP data. Please refer to the corresponding README file for detailed information on each analysis module.

### Module summary

The table below provides a brief description of the module, including the required input data and expected outputs. It is intended to help users quickly understand the files and types of data used by each analysis module, what the module does, and what output files it produces that can be consumed by other analysis modules.

| Module | Brief Description | Input Data | Output Data | Remarks |
| :--- | :--- | :--- | :--- | :--- |
| [data-preprocessing](https://github.com/ewafula/scPhylogenomics/tree/main/analyses/data-preprocessing) | Preprocesses high-throughput 10x Genomics Chromium scRNA-Seq datasets for subsequent clonal mutational profiling using other scPhylogenomics analysis modules | - 10x Cell Ranger count raw and filtered feature barcode matrix data (i.e., `barcodes.tsv.gz`, `features.tsv.gz`, and `matrix.mtx.gz`) | - SoupX, DoubletFinder, miQC filtered feature barcode matrix data (i.e., `barcodes.tsv.gz`, `features.tsv.gz`, and `matrix.mtx.gz`)<br> - Summary QC plots (PDFs) and tables | - Input and output matrix data are loaded and saved respectively in the local repo `data/` directory of the scPhylogenomics workflow |
| [cell-typing](https://github.com/ewafula/scPhylogenomics/tree/main/analyses/cell-typing) | Consolidates preprocessed 10x scRNA-Seq samples and annotate cell types to facilitate cancer mutational profiling | - Filtered feature barcode matrix data (from data-preprocessing)<br> - Cell type reference datasets | - Consolidated and annotated project RDS data objects<br> - Project cell type annotation tables (`.tsv.gz`)<br> - Analysis summary plots (Elbow plots, UMAPs, and Heatmaps) | - Seurat objects (RDS files) are generally too large to upload to GitHub |
| [ploidy-inference](https://github.com/ewafula/scPhylogenomics/tree/main/analyses/ploidy-inference) | Infers ploidy from single-cell gene expression data to classify cells as diploid (normal) or aneuploid (tumor) | - Annotated Seurat RDS objects (from cell-typing module) | - Cell ploidy prediction tables (`.tsv.gz`)<br> - Ploidy prediction RDS objects<br> - CopyKAT Heatmaps (`.jpeg`) and UMAP plots (`.pdf`) | - Distinguishes tumor vs. normal cells for downstream filtering |
| [snv-calling](https://github.com/ewafula/scPhylogenomics/tree/main/analyses/snv-calling) | Performs single-cell SNV calling on specific cell populations using **cellsnp-lite** to characterize somatic variants | - Cell type barcodes (from cell-typing)<br> - BAM files (aligned reads)<br> - Common SNP reference VCF (optional) | - Filtered genotype matrices (`AD`, `DP`, `OTH`)<br> - Filtered variant VCFs (`.base.vcf.gz`)<br> - Pseudo-bulk Multiple Sequence Alignments (`.msa.fasta.gz`) | - Generates the foundational mutation matrices used for phylogeny reconstruction |
| [phylogeny-inference](https://github.com/ewafula/scPhylogenomics/tree/main/analyses/phylogeny-inference) | Infers evolutionary trees and reconstructs clonal architecture using **Deep Learning (Manifold)** or **Hierarchical (WNMF)** clustering | - Genotype matrices (AD/DP) and VCFs (from snv-calling)<br> - Multiple Sequence Alignments (MSA) | - Phylogenetic trees (FastTree/IQ-TREE `.tree` and `.treefile`)<br> - Clonal assignment tables (`clones.manifold.tsv.gz` / `clones.hierarchical.tsv.gz`)<br> - Annotated clonal tree plots (`.png`)<br> - Clustering visualizations (3D Scatter plots, Heatmaps) | - Unified interface supporting VAE-based (SNPmanifold) and NMF-based clonal reconstruction |
